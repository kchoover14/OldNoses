options(width = 250)
options(max.print = .Machine$integer.max)
library(dplyr); library(Biostrings)

or1a1.dna = readDNAStringSet("or1a1-dna.fas")
or1c1.dna = readDNAStringSet("or1c1-dna.fas")
or2a25.dna = readDNAStringSet("or2a25-dna.fas")
or2b11.dna = readDNAStringSet("or2b11-dna.fas")
or2c1.dna = readDNAStringSet("or2c1-dna.fas")
or2j2.dna = readDNAStringSet("or2j2-dna.fas")
or2j3.dna = readDNAStringSet("or2j3-dna.fas")
or2w1.dna = readDNAStringSet("or2w1-dna.fas")
or4e2.dna = readDNAStringSet("or4e2-dna.fas")
or4q3.dna = readDNAStringSet("or4q3-dna.fas")
or5a1.dna = readDNAStringSet("or5a1-dna.fas")
or5an1.dna = readDNAStringSet("or5an1-dna.fas")
or5k1.dna = readDNAStringSet("or5k1-dna.fas")
or5p3.dna = readDNAStringSet("or5p3-dna.fas")
or6p1.dna = readDNAStringSet("or6p1-dna.fas")
or7c1.dna = readDNAStringSet("or7c1-dna.fas")
or7d4.dna = readDNAStringSet("or7d4-dna.fas")
or8b3.dna = readDNAStringSet("or8b3-dna.fas")
or8d1.dna = readDNAStringSet("or8d1-dna.fas")
or8k3.dna = readDNAStringSet("or8k3-dna.fas")
or10a6.dna = readDNAStringSet("or10a6-dna.fas")
or10g3.dna = readDNAStringSet("or10g3-dna.fas")
or10g4.dna = readDNAStringSet("or10g4-dna.fas")
or10g7.dna = readDNAStringSet("or10g7-dna.fas")
or10j5.dna = readDNAStringSet("or10j5-dna.fas")
or11a1.dna = readDNAStringSet("or11a1-dna.fas")
or51e1.dna = readDNAStringSet("or51e1-dna.fas")
or51e2.dna = readDNAStringSet("or51e2-dna.fas")
or51l1.dna = readDNAStringSet("or51l1-dna.fas")
or56a4.dna = readDNAStringSet("or56a4-dna.fas")

#function and code from:
#https://stackoverflow.com/questions/48402460/identifying-amino-acid-substitutions-from-local-alignments-in-r
mismatches <- function(query, ref) {
    pairwiseAlignment(ref, query, substitutionMatrix = "BLOSUM100") %>%
        mismatchTable() %>%
        mutate(ID=names(query),
               Pos=PatternStart,
               Reference_DNA=as.character(PatternSubstring),
               Sample_DNA=as.character(SubjectSubstring)) %>%
        select(ID, Reference_DNA, Sample_DNA, Pos)
}

bind_rows(mismatches(or1a1.dna[2], or1a1.dna[1]), mismatches(or1a1.dna[2], or1a1.dna[1]))
bind_rows(mismatches(or1c1.dna[2], or1c1.dna[1]), mismatches(or1c1.dna[2], or1c1.dna[1]))
bind_rows(mismatches(or2a25.dna[2], or2a25.dna[1]), mismatches(or2a25.dna[2], or2a25.dna[1]))
bind_rows(mismatches(or2b11.dna[2], or2b11.dna[1]), mismatches(or2b11.dna[2], or2b11.dna[1]))
bind_rows(mismatches(or2c1.dna[2], or2c1.dna[1]), mismatches(or2c1.dna[2], or2c1.dna[1]))
bind_rows(mismatches(or2j2.dna[2], or2j2.dna[1]), mismatches(or2j2.dna[2], or2j2.dna[1]))
bind_rows(mismatches(or2j3.dna[2], or2j3.dna[1]), mismatches(or2j3.dna[2], or2j3.dna[1]))
bind_rows(mismatches(or2w1.dna[2], or2w1.dna[1]), mismatches(or2w1.dna[2], or2w1.dna[1]))
bind_rows(mismatches(or4e2.dna[2], or4e2.dna[1]), mismatches(or4e2.dna[2], or4e2.dna[1]))
bind_rows(mismatches(or4q3.dna[2], or4q3.dna[1]), mismatches(or4q3.dna[2], or4q3.dna[1]))
bind_rows(mismatches(or5a1.dna[2], or5a1.dna[1]), mismatches(or5a1.dna[2], or5a1.dna[1]))
bind_rows(mismatches(or5an1.dna[2], or5an1.dna[1]), mismatches(or5an1.dna[2], or5an1.dna[1]))
bind_rows(mismatches(or5k1.dna[2], or5k1.dna[1]), mismatches(or5k1.dna[2], or5k1.dna[1]))
bind_rows(mismatches(or5p3.dna[2], or5p3.dna[1]), mismatches(or5p3.dna[2], or5p3.dna[1]))
bind_rows(mismatches(or6p1.dna[2], or6p1.dna[1]), mismatches(or6p1.dna[2], or6p1.dna[1]))
bind_rows(mismatches(or7c1.dna[2], or7c1.dna[1]), mismatches(or7c1.dna[2], or7c1.dna[1]))
bind_rows(mismatches(or7d4.dna[2], or7d4.dna[1]), mismatches(or7d4.dna[2], or7d4.dna[1]))
bind_rows(mismatches(or8b3.dna[2], or8b3.dna[1]), mismatches(or8b3.dna[2], or8b3.dna[1]))
bind_rows(mismatches(or8d1.dna[2], or8d1.dna[1]), mismatches(or8d1.dna[2], or8d1.dna[1]))
bind_rows(mismatches(or8k3.dna[2], or8k3.dna[1]), mismatches(or8k3.dna[2], or8k3.dna[1]))
bind_rows(mismatches(or10a6.dna[2], or10a6.dna[1]), mismatches(or10a6.dna[2], or10a6.dna[1]))
bind_rows(mismatches(or10g3.dna[2], or10g3.dna[1]), mismatches(or10g3.dna[2], or10g3.dna[1]))
bind_rows(mismatches(or10g4.dna[2], or10g4.dna[1]), mismatches(or10g4.dna[2], or10g4.dna[1]))
bind_rows(mismatches(or10g7.dna[2], or10g7.dna[1]), mismatches(or10g7.dna[2], or10g7.dna[1]))
bind_rows(mismatches(or10j5.dna[2], or10j5.dna[1]), mismatches(or10j5.dna[2], or10j5.dna[1]))
bind_rows(mismatches(or11a1.dna[2], or11a1.dna[1]), mismatches(or11a1.dna[2], or11a1.dna[1]))
bind_rows(mismatches(or51e1.dna[2], or51e1.dna[1]), mismatches(or51e1.dna[2], or51e1.dna[1]))
bind_rows(mismatches(or51e2.dna[2], or51e2.dna[1]), mismatches(or51e2.dna[2], or51e2.dna[1]))
bind_rows(mismatches(or51l1.dna[2], or51l1.dna[1]), mismatches(or51l1.dna[2], or51l1.dna[1]))
bind_rows(mismatches(or56a4.dna[2], or56a4.dna[1]), mismatches(or56a4.dna[2], or56a4.dna[1]))

sink("substitutions-dna-raw data.txt", append=FALSE)
bind_rows(lapply(seq_along(or1a1.dna[-1]), function(i) mismatches(or1a1.dna[i+1], or1a1.dna[1])))
bind_rows(lapply(seq_along(or1c1.dna[-1]), function(i) mismatches(or1c1.dna[i+1], or1c1.dna[1])))
bind_rows(lapply(seq_along(or2a25.dna[-1]), function(i) mismatches(or2a25.dna[i+1], or2a25.dna[1])))
bind_rows(lapply(seq_along(or2b11.dna[-1]), function(i) mismatches(or2b11.dna[i+1], or2b11.dna[1])))
bind_rows(lapply(seq_along(or2c1.dna[-1]), function(i) mismatches(or2c1.dna[i+1], or2c1.dna[1])))
bind_rows(lapply(seq_along(or2j2.dna[-1]), function(i) mismatches(or2j2.dna[i+1], or2j2.dna[1])))
bind_rows(lapply(seq_along(or2j3.dna[-1]), function(i) mismatches(or2j3.dna[i+1], or2j3.dna[1])))
bind_rows(lapply(seq_along(or2w1.dna[-1]), function(i) mismatches(or2w1.dna[i+1], or2w1.dna[1])))
bind_rows(lapply(seq_along(or4e2.dna[-1]), function(i) mismatches(or4e2.dna[i+1], or4e2.dna[1])))
bind_rows(lapply(seq_along(or4q3.dna[-1]), function(i) mismatches(or4q3.dna[i+1], or4q3.dna[1])))
bind_rows(lapply(seq_along(or5a1.dna[-1]), function(i) mismatches(or5a1.dna[i+1], or5a1.dna[1])))
bind_rows(lapply(seq_along(or5an1.dna[-1]), function(i) mismatches(or5an1.dna[i+1], or5an1.dna[1])))
bind_rows(lapply(seq_along(or5k1.dna[-1]), function(i) mismatches(or5k1.dna[i+1], or5k1.dna[1])))
bind_rows(lapply(seq_along(or5p3.dna[-1]), function(i) mismatches(or5p3.dna[i+1], or5p3.dna[1])))
bind_rows(lapply(seq_along(or6p1.dna[-1]), function(i) mismatches(or6p1.dna[i+1], or6p1.dna[1])))
bind_rows(lapply(seq_along(or7c1.dna[-1]), function(i) mismatches(or7c1.dna[i+1], or7c1.dna[1])))
bind_rows(lapply(seq_along(or7d4.dna[-1]), function(i) mismatches(or7d4.dna[i+1], or7d4.dna[1])))
bind_rows(lapply(seq_along(or8b3.dna[-1]), function(i) mismatches(or8b3.dna[i+1], or8b3.dna[1])))
bind_rows(lapply(seq_along(or8d1.dna[-1]), function(i) mismatches(or8d1.dna[i+1], or8d1.dna[1])))
bind_rows(lapply(seq_along(or8k3.dna[-1]), function(i) mismatches(or8k3.dna[i+1], or8k3.dna[1])))
bind_rows(lapply(seq_along(or10a6.dna[-1]), function(i) mismatches(or10a6.dna[i+1], or10a6.dna[1])))
bind_rows(lapply(seq_along(or10g3.dna[-1]), function(i) mismatches(or10g3.dna[i+1], or10g3.dna[1])))
bind_rows(lapply(seq_along(or10g4.dna[-1]), function(i) mismatches(or10g4.dna[i+1], or10g4.dna[1])))
bind_rows(lapply(seq_along(or10g7.dna[-1]), function(i) mismatches(or10g7.dna[i+1], or10g7.dna[1])))
bind_rows(lapply(seq_along(or10j5.dna[-1]), function(i) mismatches(or10j5.dna[i+1], or10j5.dna[1])))
bind_rows(lapply(seq_along(or11a1.dna[-1]), function(i) mismatches(or11a1.dna[i+1], or11a1.dna[1])))
bind_rows(lapply(seq_along(or51e1.dna[-1]), function(i) mismatches(or51e1.dna[i+1], or51e1.dna[1])))
bind_rows(lapply(seq_along(or51e2.dna[-1]), function(i) mismatches(or51e2.dna[i+1], or51e2.dna[1])))
bind_rows(lapply(seq_along(or51l1.dna[-1]), function(i) mismatches(or51l1.dna[i+1], or51l1.dna[1])))
bind_rows(lapply(seq_along(or56a4.dna[-1]), function(i) mismatches(or56a4.dna[i+1], or56a4.dna[1])))
sink()

